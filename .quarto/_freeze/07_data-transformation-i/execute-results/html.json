{
  "hash": "3b205384541c6296b70fa79fac1c5e4a",
  "result": {
    "markdown": "\n# Data Transformation: Organizing rows & Columns\n\n\n\n\n\n\n**Learning Objectives**\n\nAfter completing this lab you should be able to \n\n* use `filter()` and `select()` to include/exclude rows and columns from a data frame.\n* use `distinct()` to select only unique/distinct rows from a data frame.\n* use `separate()` and `unite()` to separate content from a column across multiple columns and vice versa.\n\nFor each of our modules we will have a project-folder with an `Rproject`, `*.qmd`-files, and sub-directories for data, scripts, and results as described in our `Rproject` Tutorial. You should have a directory on your Desktop or Documents folder on your laptop (name it something like `bi349`) as a home directory for all of our project folders this semester. \n\n[You should have already downloaded the project directory for this module](https://drive.google.com/drive/folders/1Sh4mtvdii1k_vU4-mfvgIGwJsZvo8MOt?usp=sharing), make sure the directory is unzipped and move it to your `bi328` directory. You can open the `Rproj` for this module either by double clicking on it which will launch `Rstudio` or by opening `Rstudio` and then using `File > Open Project` or by clicking on the `Rproject` icon in the top right of your program window and selecting `Open Project`. \n\nOnce you have opened a project you should see the project name in the top right corner^[Pro tip: If you run into issues where a quarto document won't render or file paths aren't working (especially if things were working previously) one of your first steps should be to double check that the correct `Rproj` is loaded.].\n\nThere should be a document named `07_data-transformation-i.qmd` in your project directory. Use that file to work through this tutorial - you will hand in your rendered (\"knitted\") `quarto` file as your homework assignment. So, first thing in the `YAML` header, change the author to your name. You will use this `quarto` document to record your answers. Remember to use comments to annotate your code; at minimum you should have one comment per code set^[You should do this whether you are adding code yourself or using code from our manual, even if it isn't commented in the manual... especially when the code is already included for you, add comments to describe how the function works/what it does as we introduce it during the participatory coding session so you can refer back to it.] you may of course add as many comments as you need to be able to recall what you did]. Similarly, take notes in the document as we discuss discussion/reflection questions but make sure that you go back and clean them up for \"public consumption\".\n\nLet's start by loading the packages we will need for this activity.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(knitr)\nlibrary(tidyverse)\n```\n:::\n\n\n## Data Wrangling\n\nNow that we have a data frame to play with, let's explore some data wrangling options using `dplyr`. The `d` stands for `data` and the `plyr` stands for `plyers` - this package is designed to manipulate data frames^[This is also known as `data wrangling` or `data munging`, manipulating is not a negative thing in this case it means you can clean up and format the data in appropriate way to fit the questions you are asking and allow to to transform the information in a helpful way so that you can apply analysis and modeling as needed in the next step]. We are going to focus on the central actions (`verbs`) that will allow you to manipulate the data frame.\n\nThe main advantages to using a command line program like R/code compared to a spreadsheet program such as Excel or Google sheets are:\n\n* You aren't manipulating the raw data set - if you make a mistake or accidentally overwrite something you haven't made any permanent damage.\n* You can manipulate data sets too large to easily handle in a spreadsheet\n* If you update your data set or have a second identically formatted data set you just have to re-run the code.\n\nBe sure to record all the steps (code chunks) in your `quarto` document - both the examples given here and the applications you will be asked to make. You can copy and paste, but you will find that writing out the code will help you get more used to syntax, how auto complete etc. works. Be sure to annotate/comment your code as reminders while we go through new functions in class, and that you take the time to go over your comments before submitting your knotted `*.html` document. \n\nThese are central concepts that you will use and reuse throughout the semester so you will likely want to refer back to this document. A good way to create a \"cheatsheet\" would be to for example for each function write a short description of what it does in general before each code chunk, then make your comment in the code specific to your example. Similarly use normal text to refer to the question numbers in this manual as you work through the problem sets.\n\n\n## Selecting and organizing columns\n\nLet's start by loading our data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read catch data\ncatch <- read_delim(\"data/longline_catchdata.txt\", delim = \"\\t\")\n```\n:::\n\n\n::: {.callout-warning}\n\n## Be mindful\n\nWe will make heavy use of the magrittr pipe `%>%` this smester which allows you to link commands together; think of it as \"and now do this\". R for Data Science (2e) implements the native R pipe `|>`. For our intents and purposes they are identical.\n\nBecause we are mostly interested in what the individual functions (verbs) do we will not always assign a new object, but just having it print to the console/below the code chunk we will be able to immediately assess the affect. By piping our function to `head()` it will print just the first 6 lines.\n\n:::\n\n\nThe function `select()` is used to select a subset of columns from a data set.\n\nFor example, you can select just the Site and Species columns^[Remember, the function `head()` allows you to just print the first few lines of the dataframe to the console, otherwise you can end up with several thousand lines!].\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  select(Site, Species) %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n  Site        Species      \n  <chr>       <chr>        \n1 Aransas_Bay Bagre_marinus\n2 Aransas_Bay Bagre_marinus\n3 Aransas_Bay Bagre_marinus\n4 Aransas_Bay Bagre_marinus\n5 Aransas_Bay Bagre_marinus\n6 Aransas_Bay Bagre_marinus\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you select just Day, Month, and Year columns?\n\n:::\n\nYou can also specify individual columns to eliminate by name. For example, the `PCL` column doesn't contain any information (all `NA`s).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  select(-PCL) %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 11\n  Site      Species Sex   Observed_Stage    FL   STL Hook_Size   Set   Day Month\n  <chr>     <chr>   <chr> <chr>          <dbl> <dbl>     <dbl> <dbl> <dbl> <dbl>\n1 Aransas_… Bagre_… U     <NA>             287   353        10     1    28     7\n2 Aransas_… Bagre_… U     <NA>             425   495        10     1    28     7\n3 Aransas_… Bagre_… U     <NA>             416   502        15     1    28     7\n4 Aransas_… Bagre_… U     <NA>             416   507        10     1    28     7\n5 Aransas_… Bagre_… U     <NA>             418   510        15     1    28     7\n6 Aransas_… Bagre_… U     <NA>             434   515        10     1    28     7\n# ℹ 1 more variable: Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you eliminate hook size from the data set?\n\n:::\n\n\nYou can also eliminate multiple columns by name, for example you would remove `Day`, `Month` and `Year` like this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  select(-Day, -Month, -Year) %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 9\n  Site        Species     Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set\n  <chr>       <chr>       <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl>\n1 Aransas_Bay Bagre_mari… U     <NA>              NA   287   353        10     1\n2 Aransas_Bay Bagre_mari… U     <NA>              NA   425   495        10     1\n3 Aransas_Bay Bagre_mari… U     <NA>              NA   416   502        15     1\n4 Aransas_Bay Bagre_mari… U     <NA>              NA   416   507        10     1\n5 Aransas_Bay Bagre_mari… U     <NA>              NA   418   510        15     1\n6 Aransas_Bay Bagre_mari… U     <NA>              NA   434   515        10     1\n```\n:::\n:::\n\n\nIf you want to re-arrange columns in your data frame, you would also use `select()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  select(FL, Sex, Day) %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n     FL Sex     Day\n  <dbl> <chr> <dbl>\n1   287 U        28\n2   425 U        28\n3   416 U        28\n4   416 U        28\n5   418 U        28\n6   434 U        28\n```\n:::\n:::\n\n\n::: {.callout-tip}\n\n## Protip\n\nIf you wanted to move a set of columns to the front, but not not want to have to type in all the other column names you can use `everything()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  select(Day, Month, Year, everything()) %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 12\n    Day Month  Year Site        Species   Sex   Observed_Stage   PCL    FL   STL\n  <dbl> <dbl> <dbl> <chr>       <chr>     <chr> <chr>          <dbl> <dbl> <dbl>\n1    28     7  2015 Aransas_Bay Bagre_ma… U     <NA>              NA   287   353\n2    28     7  2015 Aransas_Bay Bagre_ma… U     <NA>              NA   425   495\n3    28     7  2015 Aransas_Bay Bagre_ma… U     <NA>              NA   416   502\n4    28     7  2015 Aransas_Bay Bagre_ma… U     <NA>              NA   416   507\n5    28     7  2015 Aransas_Bay Bagre_ma… U     <NA>              NA   418   510\n6    28     7  2015 Aransas_Bay Bagre_ma… U     <NA>              NA   434   515\n# ℹ 2 more variables: Hook_Size <dbl>, Set <dbl>\n```\n:::\n:::\n\n\n:::\n\nThere you go, creating subsets of columns: Simple as that.\n\n\n## Separating & uniting columns\n\nOccasionally you will find that you want to combine the contents of two columns into a single column (e.g. first name, last name) or at other times you may want to separate the contents of a column over multiple columns (e.g. dates). \n\nFor example, you may have noticed that the Species is entered as `genus_species` - what if you wanted to have two separate columns with that information? \n\nThe function `separate()` will split the contents from one column across two or more columns. To do this you need to specify the new column names (`into = c(\"column1\", \"column2\")`), and what pattern should be used to determine where the content should be split (`sep = \"pattern\"`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  separate(Species, into = c(\"species\", \"genus\"), sep = \"_\", remove = FALSE) %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 14\n  Site    Species species genus Sex   Observed_Stage   PCL    FL   STL Hook_Size\n  <chr>   <chr>   <chr>   <chr> <chr> <chr>          <dbl> <dbl> <dbl>     <dbl>\n1 Aransa… Bagre_… Bagre   mari… U     <NA>              NA   287   353        10\n2 Aransa… Bagre_… Bagre   mari… U     <NA>              NA   425   495        10\n3 Aransa… Bagre_… Bagre   mari… U     <NA>              NA   416   502        15\n4 Aransa… Bagre_… Bagre   mari… U     <NA>              NA   416   507        10\n5 Aransa… Bagre_… Bagre   mari… U     <NA>              NA   418   510        15\n6 Aransa… Bagre_… Bagre   mari… U     <NA>              NA   434   515        10\n# ℹ 4 more variables: Set <dbl>, Day <dbl>, Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nIn some cases, there might not be a distinct pattern that you can use to identify where to split the column content. In this case it may be more helpful to use the position (e.g. \"split at \"third character from the left\") Look up the `separate()` function in the help tab and determine how you could split the `Year` column so you get two new columns by splitting off the last two digits (i.e. 2021 would be 20 and 21). Then eliminate the column containing the first two digits.\n\n:::\n\n\nIn other cases you might have information in two columns that you want to combine into a single column. This can be accomplished using the function `unite()`. \n\nFor example, if we wanted to create a column called date that had the day, month, and year of each sampling trip separated by an `_`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  unite(Date, Day, Month, Year, sep = \"_\", remove = FALSE) %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 13\n  Site      Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set Date \n  <chr>     <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <chr>\n1 Aransas_… Bagre_… U     <NA>              NA   287   353        10     1 28_7…\n2 Aransas_… Bagre_… U     <NA>              NA   425   495        10     1 28_7…\n3 Aransas_… Bagre_… U     <NA>              NA   416   502        15     1 28_7…\n4 Aransas_… Bagre_… U     <NA>              NA   416   507        10     1 28_7…\n5 Aransas_… Bagre_… U     <NA>              NA   418   510        15     1 28_7…\n6 Aransas_… Bagre_… U     <NA>              NA   434   515        10     1 28_7…\n# ℹ 3 more variables: Day <dbl>, Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nCreate a data set with the following columns in this sequence and print the first few rows to the console.\n\n* Set_ID (combining day, month, year, and set)\n* Genus\n* Species\n* FL\n* STL\n\n:::\n\n\n## Sorting dataframes by a specific column content\n\nUntil you want to visualize a table how the rows are arranged is not really important. However, for example, when generating reports you might want values to be listed in a specific way. This can be done using the function `arrange()`.\n\nFor example, if we wanted to sort our dataframe based on the `Observed_Stage` column we could do the following:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  arrange(Observed_Stage)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,325 × 12\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Redfish… Sphyrn… M     MAT              622   668   850        10     1     8\n 2 Redfish… Sphyrn… M     MAT              656   710   869        10     1     8\n 3 Redfish… Sphyrn… F     MAT              708   770   979        15     2     8\n 4 Corpus_… Sphyrn… M     MAT              695   757   954        10     2    12\n 5 Corpus_… Sphyrn… F     MAT              760   861  1090        10     2    12\n 6 Corpus_… Sphyrn… M     MAT              621   689   856        10     2    27\n 7 Redfish… Sphyrn… F     MAT              781   853  1020        10     4    29\n 8 Redfish… Sphyrn… M     MAT              721   783   980        10     3    11\n 9 Redfish… Carcha… U     UND               NA    NA    NA        15     2    16\n10 Corpus_… Sphyrn… U     UND               NA    NA    NA        10     1    27\n# ℹ 2,315 more rows\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would sort your table by Sex?\n\n:::\n\n\nBy default, characters are sorted alphabetically, numeric columns from smallest to largest value. If you want to order your values from largest to smallest, you can specify that using `desc()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  arrange(desc(FL))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,325 × 12\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Aransas… Carcha… F     <NA>            1042  1140  1410        15     1    25\n 2 Redfish… Carcha… F     <NA>             812   900  1090        15     1    16\n 3 Redfish… Carcha… M     <NA>             792   882  1092        15     2    16\n 4 Corpus_… Sphyrn… F     MAT              760   861  1090        10     2    12\n 5 Redfish… Sphyrn… F     MAT              781   853  1020        10     4    29\n 6 Corpus_… Sciaen… U     <NA>              NA   841   950        10     3    25\n 7 Redfish… Carcha… M     <NA>             740   840  1010        15     3    29\n 8 Redfish… Carcha… M     <NA>             740   820  1020        10     4     1\n 9 Aransas… Carcha… M     <NA>             720   812   912        15     4    22\n10 Redfish… Sphyrn… M     MAT              721   783   980        10     3    11\n# ℹ 2,315 more rows\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would sort your site column from Z to A?\n\n:::\n\n\n## Filtering (subsetting) rows\n\nFrequently, we are less interested in being able to sort columns by content, rather, we want to extract a subset of rows based on specific content.\n\nThe function `filter()` is used to subset a data frame by row based on `regular expressions` and the `boolean operators` we previously encounter to describe the content of sets of rows.\n\nFor example, we might a `data.frame` with only Gafftop sail catfish (*Bagre marinus*)^[Remember for exact matches we use `==` not `=`].\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  filter(Species == \"Bagre_marinus\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,511 × 12\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Aransas… Bagre_… U     <NA>              NA   287   353        10     1    28\n 2 Aransas… Bagre_… U     <NA>              NA   425   495        10     1    28\n 3 Aransas… Bagre_… U     <NA>              NA   416   502        15     1    28\n 4 Aransas… Bagre_… U     <NA>              NA   416   507        10     1    28\n 5 Aransas… Bagre_… U     <NA>              NA   418   510        15     1    28\n 6 Aransas… Bagre_… U     <NA>              NA   434   515        10     1    28\n 7 Aransas… Bagre_… U     <NA>              NA   427   520        15     1    28\n 8 Aransas… Bagre_… U     <NA>              NA   446   532        10     1    28\n 9 Aransas… Bagre_… U     <NA>              NA   465   538        10     1    28\n10 Aransas… Bagre_… U     <NA>              NA   450   539        10     1    28\n# ℹ 1,501 more rows\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you select only rows containing Scalloped Hammerheads (*Sphyrna lewini*)?\"\n\n:::\n\n\nIf we want all rows but Gafftop sailfish you can use a `!` to say \"not that\" instead of having to list all the species that you do want to keep^[This is frequently called \"blacklisting\", while creating a list of content that you *do* want to keep would be referred to as \"whitelisting\".].\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  filter(!Species == \"Bagre_marinus\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 814 × 12\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Redfish… Rhizop… M     <NA>             351   378   433        15     1    29\n 2 Redfish… Sphyrn… F     <NA>             470   430   600        10     3    29\n 3 Redfish… Hypanu… F     <NA>              NA    NA   670        15     3    29\n 4 Redfish… Hypanu… F     <NA>              NA    NA   340        10     3    29\n 5 Redfish… Hypanu… M     <NA>              NA    NA   810        10     4    29\n 6 Corpus_… Carcha… F     <NA>             609   670   820        15     1    30\n 7 Corpus_… Sphyrn… M     <NA>             495   485   615        10     2    24\n 8 Corpus_… Sphyrn… F     <NA>             550   370   720        10     2    24\n 9 Corpus_… Sphyrn… M     <NA>             470   505   645        10     3    24\n10 Corpus_… Sphyrn… F     <NA>             540   565   720        10     3    24\n# ℹ 804 more rows\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you create a dataframe without Scalloped Hammerheads (*Sphyrna lewini*) entries?\n\n:::\n\n\nSometimes you might want to select rows that match one of a set of values^[Recall, the function `c()` (concatenate) creates a vector]. In this case we would use `%in%` to indicate \"keep any of these\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  filter(Species %in% c(\"Sciades_felis\", \"Bagre_marinus\", \"Synodus_foetens\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,166 × 12\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Aransas… Bagre_… U     <NA>              NA   287   353        10     1    28\n 2 Aransas… Bagre_… U     <NA>              NA   425   495        10     1    28\n 3 Aransas… Bagre_… U     <NA>              NA   416   502        15     1    28\n 4 Aransas… Bagre_… U     <NA>              NA   416   507        10     1    28\n 5 Aransas… Bagre_… U     <NA>              NA   418   510        15     1    28\n 6 Aransas… Bagre_… U     <NA>              NA   434   515        10     1    28\n 7 Aransas… Bagre_… U     <NA>              NA   427   520        15     1    28\n 8 Aransas… Bagre_… U     <NA>              NA   446   532        10     1    28\n 9 Aransas… Bagre_… U     <NA>              NA   465   538        10     1    28\n10 Aransas… Bagre_… U     <NA>              NA   450   539        10     1    28\n# ℹ 2,156 more rows\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\nAgain, if you wanted everything but rows containing those values you would preface it with a `!`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  filter(!Species %in% c(\"Sciades_felis\", \"Bagre_marinus\", \"Synodus_foetens\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 159 × 12\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Redfish… Rhizop… M     <NA>             351   378   433        15     1    29\n 2 Redfish… Sphyrn… F     <NA>             470   430   600        10     3    29\n 3 Redfish… Hypanu… F     <NA>              NA    NA   670        15     3    29\n 4 Redfish… Hypanu… F     <NA>              NA    NA   340        10     3    29\n 5 Redfish… Hypanu… M     <NA>              NA    NA   810        10     4    29\n 6 Corpus_… Carcha… F     <NA>             609   670   820        15     1    30\n 7 Corpus_… Sphyrn… M     <NA>             495   485   615        10     2    24\n 8 Corpus_… Sphyrn… F     <NA>             550   370   720        10     2    24\n 9 Corpus_… Sphyrn… M     <NA>             470   505   645        10     3    24\n10 Corpus_… Sphyrn… F     <NA>             540   565   720        10     3    24\n# ℹ 149 more rows\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you subset a data frame to contain only entries for different species in the genus Carcharhinus aka the sharky-sharks? There are four species in the data set - bullsharks (*Carcharhinus leucas*), spinner sharks (*Carcharhinus brevipinna*), blacktip sharks (*Carcharhinus limbatus*), and smalltail sharks (*Carcharhinus porosus*).\n\n:::\n\n\nFor numbers you likely aren't just searching for exact matches, you also want to be able to set threshold values and select everything above or below. For example, you can select all rows with values greater than a certain value using `>`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  filter(FL > 440)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 907 × 12\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Aransas… Bagre_… U     <NA>              NA   446   532        10     1    28\n 2 Aransas… Bagre_… U     <NA>              NA   465   538        10     1    28\n 3 Aransas… Bagre_… U     <NA>              NA   450   539        10     1    28\n 4 Aransas… Bagre_… U     <NA>              NA   496   565        10     1    28\n 5 Aransas… Bagre_… U     <NA>              NA   476   569        10     1    28\n 6 Aransas… Bagre_… U     <NA>              NA   495   570        10     1    28\n 7 Aransas… Bagre_… U     <NA>              NA   490   575        10     1    28\n 8 Aransas… Bagre_… U     <NA>              NA   486   581        10     1    28\n 9 Aransas… Bagre_… U     <NA>              NA   503   589        10     1    28\n10 Aransas… Bagre_… U     <NA>              NA   489   590        10     1    28\n# ℹ 897 more rows\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nCreate a data frame containing only entries with a forklength shorter than 300mm, then create a data frame that contains only entries with a forklength equal to or smaller than 300mm.\n\n:::\n\n\nIn this second piece of code you used a single boolean operator to include two conditions, \"smaller than\" and \"equal two\". That is a special case of wanting to retain data than fulfills one of either of two conditions and we have a specific boolean operator that can combine the two. \n\nThis is not always the case, for example, you might want to retain data that fulfills conditions in two different columns. In this case you can combine expressions using `&` to indicate that it must fulfill all conditions indicated or `|` to indicate that it must retain at least one of the.\n\nFor example to select only scalloped hammerheads that are also smaller than 300 cm you would use\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  filter(Species == \"Sphyrna_lewini\" & FL < 300)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 12\n  Site      Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n  <chr>     <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n1 Corpus_C… Sphyrn… F     <NA>             192   210   280        15     3     6\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you subset a data frame to contain only entries for different species in the genus Carcharhinus that have a forklength larger than 500 cm?\n\n:::\n\n\nBy contrast, if you wanted all entries that are either gafftops or a fork length smaller than 300 cm you could use the following code:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  filter(Species == \"Sphyrna_lewini\" | FL < 300)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 409 × 12\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Aransas… Bagre_… U     <NA>              NA   287   353        10     1    28\n 2 Aransas… Bagre_… U     <NA>              NA   285   314        10     2    28\n 3 Corpus_… Bagre_… U     <NA>              NA   299   348        10     1    30\n 4 Corpus_… Bagre_… U     <NA>              NA   297   367        10     2    30\n 5 Corpus_… Bagre_… U     <NA>              NA   298   362        10     3    30\n 6 Corpus_… Bagre_… U     <NA>              NA   290   350        10     2    24\n 7 Redfish… Bagre_… U     <NA>              NA   254   284        10     4     8\n 8 Aransas… Bagre_… U     <NA>              NA    50   574        10     1    25\n 9 Aransas… Bagre_… U     <NA>              NA   280   340         3     3    25\n10 Redfish… Bagre_… U     <NA>              NA   294   353        10     4    16\n# ℹ 399 more rows\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you select fish that have a forklength either smaller than 200 cm or larger than 300cm?\n\n:::\n\n\n## Sneak peak: grouping rows for specific wrangling actions\n\nWe have already see that it can be helpful to subset rows based on conditions that are met by the content of more than one column. In those cases, we were creating conditions based on Boolean operators.\n\nIn many cases we might be interested in subsetting a dataframe in a way where our conditions cannot be expressed by a `TRUE`/`FALSE` scenario using Boolean operators. \n\nFor example, we might want to extract the data entry for the longest fish in the data set based on forklength.\n\nThe function `max()` can be used to get the maximum value for a vector of numbers. In this case, the vector we are looking at is the `FL` column of the `catch` dataframe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  filter(FL == max(FL, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 12\n  Site      Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n  <chr>     <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n1 Aransas_… Carcha… F     <NA>            1042  1140  1410        15     1    25\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\nThat's great, now we now what the largest fish is that we caught.\n\nWhat about if we wanted to subset the dataframe to retain the largest fish based on forklength *for each species*?\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Consider this\n\nConceptually lay out the individual steps that you would need to complete to do this (don't worry about whether or not you actually know how to code this).\n\n:::\n\n\nThe tidyverse has a central concept call \"split-apply-combine\", which means that occasionally we want to group entries in a dataframe (split), do some sort of manipulation (apply), but end up with a single data frame (combine). We will look at how useful this is in the next chapter but let's take a quick sneak peak at how this is implemented in `dplyr` using `group_by()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  group_by(Species) %>%\n  filter(FL == max(FL, na.rm = TRUE)) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 12\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Corpus_… Bagre_… U     <NA>              NA   575   640        10     2    24\n 2 Aransas… Rhizop… F     <NA>             580   637   790        10     2    25\n 3 Aransas… Carcha… F     <NA>            1042  1140  1410        15     1    25\n 4 Redfish… Carcha… F     <NA>             812   900  1090        15     1    16\n 5 Corpus_… Sphyrn… F     MAT              760   861  1090        10     2    12\n 6 Aransas… Carcha… F     <NA>             690   757   940        10     2    22\n 7 Corpus_… Sphyrn… F     <NA>             520   578   770        10     1    21\n 8 Corpus_… Carcha… U     <NA>             335   415   475        10     1     3\n 9 Aransas… Sciade… U     <NA>              NA   480   548        10     2    18\n10 Aransas… Sciade… U     <NA>              NA   480   580        10     2    18\n11 Corpus_… Sciaen… U     <NA>              NA   841   950        10     3    25\n12 Corpus_… Synodu… U     <NA>              NA   173   185        10     3    30\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\nThis is also an example of how we can use the pipe (`%>%`) to string a bunch of commands, in this example we are saying \"take the object catch, and then group rows by Species and then for each group retain only the maximum forklength value for that group and then ungroup them again.\"\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you group rows by Species and then retain the individual caught on the largest hook size for each species?\n\n:::\n\n\n::: {.callout-tip}\n\n## Protip\n\nSpecifically for cases where we want to retain the largest or smallest values, we can use family of of functions called `slice()` which allow us to subset rows based on their position.\n\nFor example, we can retain the largest 5 individuals per species based on forklength using `slice_max()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  group_by(Species) %>%\n  slice_max(order_by = FL, n = 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 66 × 12\n# Groups:   Species [14]\n   Site     Species Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day\n   <chr>    <chr>   <chr> <chr>          <dbl> <dbl> <dbl>     <dbl> <dbl> <dbl>\n 1 Corpus_… Bagre_… U     <NA>              NA   575   640        10     2    24\n 2 Corpus_… Bagre_… U     <NA>              NA   574   676        10     2    21\n 3 Aransas… Bagre_… U     <NA>              NA   565    NA        10     1    17\n 4 Redfish… Bagre_… U     <NA>              NA   564   651        15     1    29\n 5 Aransas… Bagre_… U     <NA>              NA   555   541        10     3    13\n 6 Aransas… Bagre_… U     <NA>              NA   555    NA        15     1    17\n 7 Redfish… Carcha… F     <NA>             812   900  1090        15     1    16\n 8 Redfish… Carcha… M     <NA>             792   882  1092        15     2    16\n 9 Redfish… Carcha… M     <NA>             740   820  1020        10     4     1\n10 Redfish… Carcha… M     <NA>             660   722   880        10     1    20\n# ℹ 56 more rows\n# ℹ 2 more variables: Month <dbl>, Year <dbl>\n```\n:::\n:::\n\n\n\n:::\n\n\n## Create a subset with only unique entries\n\nOccasionally, you might want to create a subset of the data set that shows only the unique (distinct) entries for a specific column; this is especially common during an exploratory analysis of a data set that you are getting an overview of. This can be achieved using the function `distinct()`.\n\nFor example, we might want to know which years the survey took place.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  distinct(Year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 1\n   Year\n  <dbl>\n1  2015\n2  2016\n3  2017\n4  2018\n```\n:::\n:::\n\n\nNotice how that dropped all the other columns. You can switch that off using `.keep_all = FALSE`.\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you produce a table with only one representative per species?\n\n:::\n\n\nYou can also combine columns. For example if we wanted to determine the individual sets of the data set we could use \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch %>%\n  distinct(Day, Month, Year, Set)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 197 × 4\n     Day Month  Year   Set\n   <dbl> <dbl> <dbl> <dbl>\n 1    28     7  2015     1\n 2    28     7  2015     2\n 3    28     7  2015     3\n 4    28     7  2015     4\n 5    29     7  2015     1\n 6    29     7  2015     2\n 7    29     7  2015     4\n 8    30     7  2015     1\n 9    30     7  2015     2\n10    30     7  2015     3\n# ℹ 187 more rows\n```\n:::\n:::\n\n\n::: {.callout-note icon=false}\n\n## {{< fa clipboard-question >}}   Give it a whirl\n\nHow would you produce a table showing all the species caught per station using distinct(), presented as arranged alphabetically by Site and Species within Site?\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}