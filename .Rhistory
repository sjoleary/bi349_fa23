#| label: setup
#| include: false
# set options
knitr::opts_chunk$set(
tidy = FALSE,
message = FALSE,
warning = FALSE)
options(htmltools.dir.version = FALSE)
# load libraries (make sure you have installed them first)
library(knitr)
library(tidyverse)
# read catch data
catch <- read_delim("data/longline_catchdata.txt", delim = "\t")
catch %>%
select(Site, Species) %>%
head()
catch$Species
catch %>%
separate(Species, into = c("species", "genus"), sep = "_", remove = FALSE)
catch %>%
select(Day, Month, Year, everything())
catch %>%
unite(Date, Day, Month, Year, sep = "_", remove = FALSE)
catch %>%
filter(FL == max(FL))
View(catch)
catch %>%
group_by(Species) %>%
filter(FL == max(FL)) %>%
ungroup()
catch %>%
filter(FL == max(FL))
catch %>%
filter(FL == max(FL)) %>% View()
max_fl <- max(catch$FL)
max_fl <- max(catch$FL)
max_fl
catch %>%
filter(FL == max(FL, rm.na = TRUE))
max_fl <- max(catch$FL, na.rm = TRUE)
catch %>%
filter(FL == max(FL, na.rm = TRUE))
catch %>%
group_by(Species) %>%
filter(FL == max(FL, na.rm = TRUE)) %>%
ungroup()
catch %>%
group_by(Species) %>%
slice_max(order_by = FL, n = 5)
catch %>%
distinct(Year)
#| label: setup
#| include: false
# set options
knitr::opts_chunk$set(
tidy = FALSE,
message = FALSE,
warning = FALSE)
options(htmltools.dir.version = FALSE)
catch %>%
mutate(unknown_sex = Sex == "U")
# load libraries
library(knitr)
library(tidyverse)
catch %>%
mutate(unknown_sex = Sex == "U")
# read catch data
catch <- read_delim("data/longline_catchdata.txt", delim = "\t")
catch %>%
mutate(unknown_sex = Sex == "U")
catch %>%
mutate(unknown_sex = Sex == "U") %>% View()
catch %>%
mutate(unknown_sex = Sex == "U") %>%
select(unknown_sex, everything())
catch %>%
group_by(Species) %>%
summarize(mean_FL = mean(FL, na.rm = TRUE),
median_FL = median(FL, na.rm = TRUE),
max_FL = max(FL, na.rm = TRUE),
min_FL = min(FL, na.rm = TRUE),
sd_FL = sd(FL, na.rm = TRUE)) %>%
ungroup()
#| label: setup
#| include: false
# set options
knitr::opts_chunk$set(
tidy = FALSE,
message = FALSE,
warning = FALSE)
options(htmltools.dir.version = FALSE)
# load libraries
library(knitr)
library(tidyverse)
# read catch data
catch <- read_delim("data/longline_catchdata.txt", delim = "\t")
catch_length <- catch %>%
unite(SetID, Year, Month, Day, Set, sep = "_") %>%
select(SetID, Site, Species, Sex, PCL, FL, STL)
head(catch_length)
tidy_length <- catch_length %>%
pivot_longer(names_to = "Measurement", values_to = "Length", cols = 5:7)
tidy_length %>%
group_by(Species, Measurement) %>%
summarize(mean = mean(Length, na.rm = TRUE))
tidy_length %>%
filter(!Measurement == "PCL") %>%
group_by(Species, Measurement) %>%
summarize(mean = mean(Length, na.rm = TRUE)) %>%
pivot_wider(names_from = "Measurement", values_from = "mean")
#| label: setup
#| include: false
# set options
knitr::opts_chunk$set(
tidy = FALSE,
message = FALSE,
warning = FALSE)
options(htmltools.dir.version = FALSE)
# install packages
install.packages("FSA")
# load libraries
library(knitr)
library(tidyverse)
library(FSA)
elasmos <- read_delim("data/longline_elasmobranchs.txt", delim = "\t")
#| label: tbl-species-counts
#| tbl-cap: Number of individuals per caught per site and overall across all sites and years.
#| echo: false
kable(
elasmos %>%
group_by(Species, Site) %>%
count() %>%
pivot_wider(names_from = Site, values_from = n) %>%
replace(is.na(.), 0) %>%
mutate(Total = Aransas_Bay + Corpus_Christi_Bay + Redfish_Bay)
)
# C. brevipinna, Carlson & Baremore 2005
C.brevipinna_YOY <- filter(elasmos, Species=="Carcharhinus_brevipinna" & Sex=="M" & FL<=812 | Species=="Carcharhinus_brevipinna" & Sex=="F" & FL<=844 | Species=="Carcharhinus_brevipinna" & Sex=="U" & FL<=844) %>%
mutate(Estimated_Stage="YOY")
C.brevipinna_JUV <- filter(elasmos, Species=="Carcharhinus_brevipinna" & Sex=="M" & FL>812 & FL<=1380 | Species=="Carcharhinus_brevipinna" & Sex=="F" & FL>844 & FL<=1360 | Species=="Carcharhinus_brevipinna" & Sex=="U" & FL>844 & FL<=1360) %>%
mutate(Estimated_Stage="JUV")
C.brevipinna_MAT <- filter(elasmos, Species=="Carcharhinus_brevipinna" & Sex=="M" & FL>1380 | Species=="Carcharhinus_brevipinna" & Sex=="F" & FL>1360 | Species=="Carcharhinus_brevipinna" & Sex=="U" & FL>1360) %>%
mutate(Estimated_Stage="MAT")
# C. leucas, Neer et al. 2005
C.leucas_YOY <- filter(elasmos, Species=="Carcharhinus_leucas" & FL<=700) %>%
mutate(Estimated_Stage="YOY")
C.leucas_JUV <- filter(elasmos, Species=="Carcharhinus_leucas" & Sex=="M" & FL>700 & FL<=2100 | Species=="Carcharhinus_leucas" & Sex=="F" & FL>700 & FL<=2250 | Species=="Carcharhinus_leucas" & Sex=="U" & FL>700 & FL<=2250) %>%
mutate(Estimated_Stage="JUV")
C.leucas_MAT <- filter(elasmos, Species=="Carcharhinus_leucas" & Sex=="M" & FL>2100 | Species=="Carcharhinus_leucas" & Sex=="F" & FL>2250 | Species=="Carcharhinus_leucas" & Sex=="U" & FL>2250) %>%
mutate(Estimated_Stage="MAT")
elasmos_stage <- bind_rows(C.brevipinna_YOY, C.brevipinna_JUV, C.brevipinna_MAT,
C.leucas_YOY, C.leucas_JUV, C.leucas_MAT)
elasmos_stage <- elasmos %>%
filter(Species %in% c("Carcharhinus_leucas", "Carcharhinus_brevipinna")) %>%
mutate(Estimated_Stage = case_when(Species == "Carcharhinus_brevipinna" & Sex=="M" & FL<=812 |
Species == "Carcharhinus_brevipinna" & Sex=="F" & FL<=844 |
Species == "Carcharhinus_brevipinna" & Sex=="U" & FL<=844 ~ "YOY",
Species=="Carcharhinus_brevipinna" & Sex=="M" & FL>812 & FL<=1380 |
Species=="Carcharhinus_brevipinna" & Sex=="F" & FL>844 & FL<=1360 |
Species=="Carcharhinus_brevipinna" & Sex=="U" & FL>844 & FL<=1360 ~ "JUV",
Species=="Carcharhinus_brevipinna" & Sex=="M" & FL>1380 |
Species=="Carcharhinus_brevipinna" & Sex=="F" & FL>1360 |
Species=="Carcharhinus_brevipinna" & Sex=="U" & FL>1360 ~ "MAT",
Species=="Carcharhinus_leucas" & FL<=700 ~ "YOY",
Species=="Carcharhinus_leucas" & Sex=="M" & FL>700 & FL<=2100 |
Species=="Carcharhinus_leucas" & Sex=="F" & FL>700 & FL<=2250 |
Species=="Carcharhinus_leucas" & Sex=="U" & FL>700 & FL<=2250 ~ "JUV",
Species=="Carcharhinus_leucas" & Sex=="M" & FL>2100 |
Species=="Carcharhinus_leucas" & Sex=="F" & FL>2250 |
Species=="Carcharhinus_leucas" & Sex=="U" & FL>2250 ~ "MAT"))
elasmos <- read_delim("data/elasmos_complete.txt", delim = "\t")
kable(
elasmos %>%
filter(Estimated_Stage == "YOY") %>%
group_by(Site, Year, Species) %>%
count() %>%
arrange(Year) %>%
pivot_wider(names_from = Year, values_from = n) %>%
replace(is.na(.), 0) %>%
arrange(Site, Species)
)
